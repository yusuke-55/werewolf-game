# 1人用人狼ゲーム

このゲームは、あなたが村長（進行役）となり、9人の登場人物の中から人狼を見つけ出す
ブラウザで遊べる 1人用の人狼ゲーム です。

ゲームはサーバー側で自動進行し、
会話・投票・処刑・夜の結果などが リアルタイムで画面に表示 されます。

人狼ゲームを知らない方でも、
「ログを読みながら、必要なときに指示を出す」だけで遊べます。

---

## このゲームでできること（特徴）
プレイヤー1人 + 9人のCPU で進行する人狼ゲーム
以下 6つの役職 を実装
村人：3人
人狼：2人
占い師：1人
霊媒師：1人
騎士：1人
狂人：1人

昼・夜フェーズを含む、本格的な人狼ルール
ゲームの進行を リアルタイムで観戦
落ち着いた ダークテーマUI
TypeScript + オブジェクト指向による実装

---

## 工夫した点
- ゲーム進行をフェーズ単位の状態遷移として設計し、進行管理を明確化
- 各役職をクラスとして分離し、役職追加・変更がしやすい構成にした
- サーバー主導でゲームを進行し、その状態をSSEでクライアントへ配信する設計を採用

---

## 準備・起動方法

### 1. 依存関係のインストール

プロジェクトで使用しているライブラリをインストールします。

```bash
npm install
```

### 2. アプリケーションの起動

開発用サーバーを起動します。

```bash
npm run dev
```

起動後、ブラウザで表示されるURL（例: `http://localhost:3000`）にアクセスしてください。

---

## 遊び方

### 1) 名前・アイコンを設定（任意）

タイトル画面の「設定」から、あなたの表示名とアイコンを変更できます（ブラウザに保存されます）。

### 2) ゲーム開始

1. タイトル画面の「ゲーム開始」をクリック。

ゲームが始まると、左側のログに会話や結果がリアルタイムで流れます。

### 3) 画面の見方

- 上部：「タイトル画面に戻る」：ゲームをリセットしてタイトルへ戻ります
- 左側：ログ（発言、投票、処刑、夜の結果などが表示されます）
- 右側：
   - 「プレイヤー情報」：生存/死亡などの一覧
   - 「占い＆霊能結果」：公開された占い・霊能結果の一覧

### 4) プレイヤーのコマンド操作

ゲーム中、右側に操作パネル（「COさせる」「指定先」「個別に質問」「皆の怪しい人を聞く」「投票」）が表示されることがあります。
表示中は、あなたが村長として村人達にさまざまな指示を行えます。

- 「COさせる」：占い師/霊能者/狩人にカミングアウト（CO）を促します
- 「指定先」：投票先・占い先・護衛先などを指定します（状況によっては指定不可の場合あり）
- 「個別に質問」：特定のプレイヤーに質問します（1日につき3回まで）
- 「皆の怪しい人を聞く」：全員に「誰が怪しいか」を聞きます（1日につき1回まで）
- 「投票」：投票へ進めます(投票後は翌日まで進行します。)

### 5) ゲーム終了

- 村人陣営、人狼陣営の勝敗が決まると、ゲーム終了です。
- ゲーム終了後は、右側に「もう一度プレイする」が表示されます。

---

## Demo

- URL: https://werewolf-game-jup7.onrender.com

---

## 技術スタック

- 言語: TypeScript
- ランタイム: Node.js
- Webフレームワーク: Express.js
- リアルタイム通信: Server-Sent Events（SSE）
- フロントエンド: Vanilla JavaScript / CSS
- ビルド: TypeScript Compiler（tsc）

---

## 実行

### ブラウザ版

```bash
# 開発モード
npm run dev

# ブラウザでアクセス
# http://localhost:3002
```

### コンソール版

```bash
npm run dev:console

npm run build
npm start
```

## Dockerでの実行

```bash
docker-compose up --build

```

---

## ゲーム仕様

### プレイヤー構成
- **人数**: 9人
- **配役**:
   - 村人: 3人
  - 人狼: 2人
  - 占い師: 1人
  - 霊媒師: 1人
  - 騎士: 1人
  - 狂人: 1人

### 役職の説明

- 村人（村人陣営）
   - 特殊能力はありません。
   - 昼の議論と投票で人狼を探します。

- 人狼（人狼陣営）
   - 夜に襲撃する相手を選びます。
   - 占い・議論で正体が露見しないように立ち回ります。

- 占い師（村人陣営）
   - 夜に1人を占い、「人間」か「人狼」かを知ります。
   - 結果を公開するか（COするか）は状況次第です。

- 霊媒師（村人陣営）
   - 昼に処刑されたプレイヤーが「人間」か「人狼」かを知ります。
   - 夜の能動的な行動はありません。

- 騎士（村人陣営）
   - 夜に1人を護衛し、人狼の襲撃から守ります。
   - 同じ相手を連続して護衛できません（前夜の護衛先は選べない仕様です）。

- 狂人（人狼陣営）
   - 夜の能動的な行動はありません。
   - 人狼陣営の勝利を助けるために、議論を攪乱したり誤情報を流したりします。

### ゲームフロー
1. **昼フェーズ**
   - 全生存者が発言
   - 投票により1名を処刑
   
2. **夜フェーズ**
   - 人狼が1名を襲撃
   - 占い師が1名を占う
   - 霊媒師は処刑者の正体を知る
   - 騎士が1名を護衛
   - 狂人は行動なし

### 勝利条件
- **村人陣営**: 人狼を全滅させる
- **人狼陣営**: 人狼の数が村人陣営と同数以上になる

## プロジェクト構造

```
werewolf-AI-prototype/
├── src/
│   ├── index.ts          # コンソール版エントリーポイント
│   ├── server.ts         # Webサーバー (Express)
│   ├── types.ts          # 型定義
│   ├── player.ts         # プレイヤークラス（役職別）
│   ├── game.ts           # ゲーム進行ロジック
│   ├── ai-logic.ts       # AI思考ロジック
│   └── events.ts         # イベントエミッター
├── public/
│   ├── index.html        # フロントエンドHTML
│   ├── style.css         # スタイルシート
│   └── app.js            # クライアントJavaScript
├── docs/
│   ├── ARCHITECTURE.md   # アーキテクチャ設計書
│   ├── API_DESIGN.md     # API設計書（今後の実装用）
│   └── DEVELOPMENT.md    # 開発ガイド
├── package.json
├── tsconfig.json
├── Dockerfile
└── docker-compose.yml
```
