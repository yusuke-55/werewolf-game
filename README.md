# 1人用人狼ゲーム

プレイヤーが村長となり、9人の村人達の中から人狼を探すゲームです。  
サーバーサイドで進行するゲームロジックを、Server-Sent Events（SSE）を用いて  
ブラウザ上にリアルタイムで可視化しています。

本プロジェクトでは **ゲームロジック設計・状態管理・リアルタイム通信** を主なテーマとして制作しました。

---

## 特徴
- プレイヤーと9人のCPUによる人狼ゲーム
- 6つの役職を実装  
  （村人3人 / 人狼2人 / 占い師1人 / 霊媒師1人 / 騎士1人 / 狂人1人）
- 昼フェーズ・夜フェーズを含む正式なゲーム進行ロジック
- Server-Sent Events（SSE）によるリアルタイム更新
- TypeScript + オブジェクト指向設計
- ダークテーマのシンプルなUI

---

## 工夫した点
- ゲーム進行をフェーズ単位の状態遷移として設計し、進行管理を明確化
- 各役職をクラスとして分離し、役職追加・変更がしやすい構成にした
- サーバー主導でゲームを進行し、その状態をSSEでクライアントへ配信する設計を採用
---

## クイックスタート（ブラウザ版）

```bash
npm install
npm run dev
```

ブラウザで `http://localhost:3002` を開き、タイトル画面の「ゲーム開始」を押してください。

## 遊び方（はじめての方向け）

このゲームは「あなたが村長（進行役）として、9人の登場人物に介入しつつ人狼を探す」1人用人狼です。

### 1) 最初にやること（名前・アイコン設定）

タイトル画面の「設定」から、あなたの表示名とアイコンを変更できます（ブラウザに保存されます）。

### 2) ゲーム開始

1. タイトル画面の「ゲーム開始」
2. 画面右上の「ゲーム開始」

ゲームが始まると、左側のログに会話や結果がリアルタイムで流れます。

### 3) 画面の見方

- 左側：ログ（発言、投票、処刑、夜の結果など）
- 上部：
   - 「ストップ」：進行を一時停止（押すと「再開」になります）
   - 「スキップ」：待ち時間を飛ばして進行を早めます
   - 「タイトル画面に戻る」：ゲームをリセットしてタイトルへ戻ります
- 右側：
   - 「プレイヤー情報」：生存/死亡などの一覧
   - 「占い＆霊能結果」：公開された占い・霊能結果の一覧

### 4) 村長として介入する（操作パネルが出たとき）

ゲーム中、右側に操作パネル（「COさせる」「指定先」「個別に質問」「皆の怪しい人を聞く」「投票」）が表示されることがあります。
表示中は、あなたが進行に介入できるタイミングです。

- 「COさせる」：占い師/霊能者/狩人にカミングアウト（CO）を促します
- 「指定先」：投票先・占い先・護衛先などを指定します（状況によっては指定不可の場合あり）
- 「個別に質問」：特定のプレイヤーに質問します（回数制限あり）
- 「皆の怪しい人を聞く」：全員に「誰が怪しいか」を聞きます（回数制限あり）
- 「投票」：投票フェーズへ進めます

### 5) 自分で選択する場面

フェーズによって、右側に選択UIが出ることがあります。

- 「投票先を選択」：ボタンから投票先を選びます
- 「占い先を選択」：ボタンから占い先を選びます

### 6) 終了・リスタート

- 勝敗が決まると、勝利/敗北の演出が表示されます
- 「もう一度プレイする」で同じ画面から再スタートできます
- 途中でやり直す場合は「タイトル画面に戻る」を使います（進行中のゲームはリセットされます）

---

## 技術スタック

- 言語: TypeScript
- ランタイム: Node.js
- Webフレームワーク: Express.js
- リアルタイム通信: Server-Sent Events（SSE）
- フロントエンド: Vanilla JavaScript / CSS
- ビルド: TypeScript Compiler（tsc）

---

## 実行

### ブラウザ版

```bash
# 開発モード
npm run dev

# ブラウザでアクセス
# http://localhost:3002
```

### コンソール版

```bash
npm run dev:console

npm run build
npm start
```

## Dockerでの実行

```bash
docker-compose up --build
```

---

## ゲーム仕様

### プレイヤー構成
- **人数**: 9人
- **配役**:
  - 人狼: 2人
  - 占い師: 1人
  - 霊媒師: 1人
  - 騎士: 1人
  - 狂人: 1人

### ゲームフロー
1. **昼フェーズ**
   - 全生存者が発言
   - 投票により1名を処刑
   
2. **夜フェーズ**
   - 人狼が1名を襲撃
   - 占い師が1名を占う
   - 霊媒師は処刑者の正体を知る
   - 騎士が1名を護衛
   - 狂人は行動なし

### 勝利条件
- **村人陣営**: 人狼を全滅させる
- **人狼陣営**: 人狼の数が村人陣営と同数以上になる

## プロジェクト構造

```
werewolf-AI-prototype/
├── src/
│   ├── index.ts          # コンソール版エントリーポイント
│   ├── server.ts         # Webサーバー (Express)
│   ├── types.ts          # 型定義
│   ├── player.ts         # プレイヤークラス（役職別）
│   ├── game.ts           # ゲーム進行ロジック
│   ├── ai-logic.ts       # AI思考ロジック
│   └── events.ts         # イベントエミッター
├── public/
│   ├── index.html        # フロントエンドHTML
│   ├── style.css         # スタイルシート
│   └── app.js            # クライアントJavaScript
├── docs/
│   ├── ARCHITECTURE.md   # アーキテクチャ設計書
│   ├── API_DESIGN.md     # API設計書（今後の実装用）
│   └── DEVELOPMENT.md    # 開発ガイド
├── package.json
├── tsconfig.json
├── Dockerfile
└── docker-compose.yml
```

### 依存関係のインストール
